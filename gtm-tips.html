<!DOCTYPE html>
<html lang="tr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta property="og:title" content="HighPing - Google Tag Manager İpuçları">
  <meta property="og:type" content="article">
  <meta property="og:description" content="Goole Tag Manager'de En Çok Kullanılan Özel Değişkenler">
  <meta property="og:url" content="https://highping.com.tr/gtm-tips">
  <meta name="author" content="Sübhan Ahmet">
  <title>HighPing - Google Tag Manager İpuçları</title>

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-NHDT4TZ');</script>
  <!-- End Google Tag Manager -->

  <link rel="stylesheet" href="styles v2.css">
</head>

<body>

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NHDT4TZ"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  <div class="accordion-body">
    <div class="wrapper">
      <div class="subhan">
        
      </div>
      <!-- <div class="allsides-7">7. Hover me </div> -->
      <div  class="nav-bar">
        <ul>
          <li>
            <a href="https://highping.com.tr" target="_blank" class="un">Ana Sayfa</a>
          </li>
          <li>
            <a href="https://blog.highping.com.tr" target="_blank" class="un">Blog</a>
          </li>
        </ul>
      </div>
      <!-- <span class="un">Underlined Text</span> -->

      <h2 class="header_text">GTM'de En Çok Kullanılan Özel Değişkenler</h2>

      <hr>


      <div class="accordion-panel">

        <div class="topic_title">
          <div class='order'>
            <span>1</span>
          </div>

          <h2>
            <button class="accordion-trigger" aria-expanded="false" aria-controls="accordion1-content">
              Sayfa Başlık Değerini Alma
            </button>
          </h2>
        </div>

        <div class="accordion-content" role="region" aria-labelledby="panel1-title" aria-hidden="true">
          <div>
            <p>Tarayıcı sekmesinde gördüğünüz site başlığını almak için <code>
              <strong>title</strong> </code> etiketini kullanabiliriz..</p>

            <pre>
function pageTitle() {
  var title = document.querySelector('title').innerText
  return title
}
</pre>



          </div>
        </div>
      </div>

      <!-- 📌 Sayfa Başlık Değeri END -->

      <hr>

      <!-- 📌 Sayfa Yenilenme Sayısı -->

      <div class="accordion-panel">

        <div class="topic_title">
          <div class='order'>
            <span>2</span>
          </div>

          <h2>
            <button class="accordion-trigger" aria-expanded="false" aria-controls="accordion1-content">
              Sayfa Yenilenme Sayısı
            </button>
          </h2>
        </div>

        <div class="accordion-content" role="region" aria-labelledby="panel1-title" aria-hidden="true">
          <div>
            <p>Bir sayfanın kullanıcı tarafından kaç defa yenilendiğini ölçebilirsiniz.</p>

            <pre>
function reloadCount() {
  var state = history.state || {};
  var reloadCount = state.reloadCount || 0;
  if (performance.navigation.type === 1) {
    state.reloadCount = ++reloadCount;
    history.replaceState(state, null, document.URL);
  } else if (reloadCount) {
    delete state.reloadCount;
    reloadCount = 0;
    history.replaceState(state, null, document.URL);
  }

  return reloadCount
}
</pre>



          </div>
        </div>
      </div>

      <!-- 📌 Sayfa Yenilenme Sayısı END -->

      <hr>

      <!-- 📌 Değişkenden Rakamlar Haricinde Her Şeyi Silmek -->

      <div class="accordion-panel">

        <div class="topic_title">
          <div class='order'>
            <span>3</span>
          </div>

          <h2>
            <button class="accordion-trigger" aria-expanded="false" aria-controls="accordion1-content">
              Değişkenden Rakamlar Haricinde Her Şeyi Silmek
            </button>
          </h2>
        </div>

        <div class="accordion-content" role="region" aria-labelledby="panel1-title" aria-hidden="true">
          <div>
            <p>
              Elde ettiğiniz değişkenden rakamlar haricindeki tüm değerleri kaldırmak için <code>
                <strong>regex</strong> </code> kullanabilirsiniz.
            </p>
            <pre>
var text = "Highping34.4--//96)qwerty%)"
var newText = text.replaceAll(/[^\d]/g, '')

// Sonuç: newText = 34496
</pre>
          </div>
        </div>
      </div>

      <!-- 📌 Değişkenden Rakamlar Haricinde Her Şeyi Silmek END -->

      <hr>

      <!-- 📌 Ürün Fiyatının Küsüratını Noktalı Yapma -->

      <div class="accordion-panel">

        <div class="topic_title">
          <div class='order'>
            <span>4</span>
          </div>

          <h2>
            <button class="accordion-trigger" aria-expanded="false" aria-controls="accordion1-content">
              Ürün Fiyatının Küsüratını Noktalı Yapma
            </button>
          </h2>
        </div>

        <div class="accordion-content" role="region" aria-labelledby="panel1-title" aria-hidden="true">
          <div>
            <p>
              GA4 de dahil olmak üzere tüm veri toplama araçları ürün fiyatı, sepet değeri ve ya sipariş
              toplam tutarını <code><strong>Number</strong></code> formatında kabul ediyor.
            </p>
            <p>
              Nedir Number formatı?
              JavaScript'te Number formatı sadece rakam kabul eden değişken türüdür.
              Rakam haricinde kabul ettiği değer noktadır. Yani küsüratları rakamla ayırabiliriz.
              Aksi taktirde ya kabul etmez ya da noktaya kadar bölümü okur, geriye kanaları görmezden gelir.
              <br>
              Tarayıcıda gördüğünüz 1,435.56, 2.567,32 şeklinde tutarları kabul etmez.
              <br>
              Bu şekilde gönderdiğiniz değerlerden 1. fiyatı 435.56, 2. fiyatı 32 tl olarak okuyacaktır.
              Aralarında çok büyük fark olduğunu söylemeye gerek yoktur.
              <br>
              Yani GA4'ün kabul ettiği değerlerin 1435.56 TRY ve 2567.32 TRY (para birimi olmadan) şeklinde
              olması gerekiyor. <br>
              <br>
              Bunun için yapılacak bir kaç işlem var; önce <code><strong>replace</strong></code>
              metodunu ele alalım.
            </p>

            <hr class="hr-text" id="hr-border" data-content="replace">

            <pre>
// Yüz, bin, yüzbin ve ya milyonluk değerlerin virgül ile ayrıldığı, küsüratın ise nokta ile ayrıldığı değerler.
// Bu tür değerlerden noktaya dokunmadan virgülü silersek işlem tamamlanacak.

var fiyat = '1,567,435.56'
var yeniFiyat = fiyat.replaceAll(',','') // Yeni fiyat 1567435.56

// Tam tersi durumlarda; küsüratın virgülle, diğerlerin nokta ile ayrıldığı değerler.
// Bu tür değerlerde önce noktaları kaldırıp, sonda virgülü noktaya çevirebiliriz.

var fiyat = '1.567.435,56'
var yeniFiyat = fiyat.replaceAll('.','').replace(',','.') // Yeni fiyat 1567435.56
</pre>

            <p>
              <code><strong>replace</strong> ve <strong>replaceAll</strong></code> haricinde bir fonksiyon
              var ki girilen tüm değerlerin küsüratını noktalı yapar.
            </p>

            <hr class="hr-text" id="hr-border" data-content="function">

            <pre>
function totalPrice() {
  var price = '1.234.564,67'
  if (price.includes(',') || price.includes('.')) {
    var commaReplacePrice = price.replaceAll(',', '.')
    
    var parts = commaReplacePrice.split('.');
    if (price.length <= 4) {
      return Number(price)
    } else {
      return Number(parts.slice(0, -1).join('') + '.' + parts.slice(-1))
    }
  } else {
    return Number(price)
  }
}
</pre>
          </div>
        </div>
      </div>

      <!-- 📌 Ürün Fiyatının Küsüratını Noktalı Yapma END -->

      <hr>

      <!-- 📌 Tıklanan Elementin Değerlerini Alma -->
      <div class="accordion-panel">

        <div class="topic_title">
          <div class='order'>
            <span>5</span>
          </div>

          <h2>
            <button class="accordion-trigger" aria-expanded="false" aria-controls="accordion1-content">
              Tıklanan Elementin Değerlerini Alma
            </button>
          </h2>
        </div>

        <div class="accordion-content" role="region" aria-labelledby="panel1-title" aria-hidden="true">
          <div>
            <p>JavaScript'te <code><strong>addEventListener</strong></code> ve ya
              <code><strong>onclick</strong></code> metodları ile tarayıcıda tıklanan
              öğenin elementini yakayabiliriz.</p>
            <p>
              Önce metodu konsola yazarak doğruluğunu kontrol ediyoruz:
            </p>

            <hr class="hr-text" id="hr-border" data-content="addEventListener">

            <pre>
document.addEventListener("click", function (event) {
    var targetElement = event.target;
    console.log(targetElement);
    return "";
});
</pre>

            <hr class="hr-text" id="hr-border" data-content="onlick">

            <pre>
document.onclick = function (event) {
    var targetElement = event.target;
    console.log(targetElement);
    return "";
};
</pre>

            <p>Şimdi de en çok ihtiyaç duyulan elementin içindeki yazıyı, class, id ve ya varsa url değerlerini değişkene
              atayabilirsiniz.</p>

            <pre>
document.onclick = function (event) {
    elementText = event.target.innerText;
    elementClass = event.target.className;
    elementUrl = event.target.href;
    elementId = event.target.id;

    // "globalThis" değişkeni fonksyiondan çıkararak global değişken haline getirir.

    globalThis.elementText;
    globalThis.elementClass;
    globalThis.elementUrl;
    globalThis.elementId;
    return ''
};
</pre>

            <p>
              Fakat GTM tıklama takiplerini JS kodu yazmadan da takip edilebileceğimiz tetikleyiciler
              eklemiştir. <br>
              Bu tıklanmaları da kendi içinde ikiye ayırmış; Öğe Tıklanmaları ve Link Tıklanmaları. Fark
              şudur; tüm tıklamalar Öğe Tıklamalarına dahildir, Link Tıklamaları ise içinde url (href)
              barındıran buton ve ya link tıklamalarıdır. <br>
              Öğe Tıklamaları için; <b>Tıklama > Tüm Öğeler (Click > All Elements)</b>, Link Tıklamaları
              için; <b>Tıklama > Yazlınca Bağlantılar (Click > Just Links)</b> tetikleyicisini oluşturmamız
              gerekiyor. Tetikleyici, kullanıcının eylemini takip eder. Bu eylemin değerlerini değişkenler
              takip eder. Dolayısı ile sadece Click ve ya Link Click tetikleyicilerini kurmak yeterli
              sayılmaz. Aynı zamanda bu tetikleyici türüne denk değişken türlerini de aktif etmemiz
              gerekiyor. <br>
              Bunun için Değişkenler bölümünden Yerleşik Değişkenle > Tıklama türündeki
              değişkenleri aktif ediyoruz.
              İşlem sonucu şu olacak: Click tetikleyici ile tıklanan elementin Class ismini, mentini ve ya
              url değerlerini ölçebilirsiniz. <br>
              Peki GTM tetikleyicileri ile bunu yapabiliyorsak yukarıda bahsini ettiğimiz JS metdorlar ne işe yarıyor?
              <br>
              Bu metodlar yerine göre bize GTM tetikleyicilerinin ulaşamadığı yerlerde yardımcı olacaktır. Bunlardan başka konu başklıklarında bahsediyor olacağız.
            </p>

          </div>
        </div>
      </div>

      <!-- 📌 Tıklanan Elementin Değerlerini Alma END -->

      <hr>

    </div>
  </div>

  <script src="/index v2.js" type="text/javascript"></script>



</body>

</html>
